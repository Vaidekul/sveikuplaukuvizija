var DAHZ = DAHZ || {};

( function ( $ ) {
	'use strict';

	DAHZ.init = {
		countInit: function() {
			$(window).load(function() {
				$('.de-sc-countdown-wrapper:not(.initialized)').each( function() {
					var $this = $(this),
						finalDate = $(this).data('terminal-date'),
						countFormat = $(this).data('countformat'),
						params = $(this).parent().data('dahz-shortcode-atts'),
						tSingular = [
							params.translation_year,
							params.translation_month, 
							params.translation_week,
							params.translation_day,
							params.translation_hour,
							params.translation_minute,
							params.translation_second
						],
						singular = $.makeArray(tSingular),
						tPlural = [
							params.translation_years, 
							params.translation_months, 
							params.translation_weeks,
							params.translation_days,
							params.translation_hours,
							params.translation_minutes,
							params.translation_seconds
						],
						plural = $.makeArray(tPlural),
						until = new Date( finalDate );

					$this.countdown({labels: plural, labels1: singular, until: until, format: countFormat, padZeroes:true});
					$( this ).addClass( 'initialized' );
				});
				// $('.de-sc-countdown-wrapper').countdown('pause'); 
			});
			$(document).on( 'shortcode_count_down_ready', function() {
				$('.de-sc-countdown-wrapper:not(.initialized)').each( function() {
					var $this = $(this),
						finalDate = $(this).data('terminal-date'),
						countFormat = $(this).data('countformat'),
						params = $(this).parent().data('dahz-shortcode-atts'),
						tSingular = [
							params.translation_year,
							params.translation_month, 
							params.translation_week,
							params.translation_day,
							params.translation_hour,
							params.translation_minute,
							params.translation_second
						],
						singular = $.makeArray(tSingular),
						tPlural = [
							params.translation_years, 
							params.translation_months, 
							params.translation_weeks,
							params.translation_days,
							params.translation_hours,
							params.translation_minutes,
							params.translation_seconds
						],
						plural = $.makeArray(tPlural),
						until = new Date( finalDate );

					$this.countdown({labels: plural, labels1: singular, until: until, format: countFormat, padZeroes:true});
					$( this ).addClass( 'initialized' );
				});
				// $('.de-sc-countdown-wrapper').countdown('pause'); 
			});
		},
	};

} ) ( jQuery );

( function( $ ) { 'use strict';

	DAHZ.init.countInit();

} ) ( jQuery );